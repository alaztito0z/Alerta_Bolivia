<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Alerta Bolivia - Plataforma de Emergencias</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1e40af"/>
<link rel="icon" type="image/png" href="icon-192.png">
<link rel="apple-touch-icon" href="icon-192.png">

<style>
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  margin: 0;
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  color: #f1f5f9;
  line-height: 1.6;
  overflow-x: hidden;
  min-height: 100vh;
}

.header {
  background: linear-gradient(135deg, #1e40af 0%, #3730a3 100%);
  color: white;
  padding: 1rem 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 1000;
  box-shadow: 0 4px 25px rgba(0,0,0,0.3);
  border-bottom: 3px solid #60a5fa;
}

.logo {
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 700;
  font-size: 1.7rem;
  cursor: pointer;
}

.logo-img {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: 2px solid #60a5fa;
  transition: transform 0.3s ease;
}

.logo:hover .logo-img {
  transform: rotate(10deg);
}

.menu {
  display: flex;
  gap: 8px;
  align-items: center;
}

.menu a {
  color: white;
  text-decoration: none;
  padding: 8px 16px;
  border-radius: 6px;
  transition: all 0.3s ease;
  font-weight: 500;
  position: relative;
}

.menu a:hover {
  background: rgba(96, 165, 250, 0.9);
  transform: translateY(-2px);
}

.menu a.active {
  background: #60a5fa;
  box-shadow: 0 4px 12px rgba(96, 165, 250, 0.4);
}

.menu a.active::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 6px;
  height: 6px;
  background: #60a5fa;
  border-radius: 50%;
}

.install-btn {
  background: linear-gradient(135deg, #10b981, #059669);
  color: white;
  border: none;
  border-radius: 6px;
  padding: 8px 16px;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 6px;
  margin-left: 8px;
}

.install-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
}

.install-btn.hidden {
  display: none;
}

.hero {
  background: linear-gradient(135deg, #1e40af 0%, #3730a3 100%);
  color: white;
  padding: 5rem 2rem 3rem;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.hero::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
}

.hero-content {
  position: relative;
  z-index: 2;
  max-width: 800px;
  margin: 0 auto;
}

.hero h1 {
  font-size: 2.8rem;
  font-weight: 800;
  margin-bottom: 1.5rem;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
  line-height: 1.2;
}

.hero p {
  font-size: 1.25rem;
  opacity: 0.95;
  margin-bottom: 2rem;
  font-weight: 300;
}

.last-update {
  text-align: center;
  color: #94a3b8;
  font-size: 0.9rem;
  margin-bottom: 2rem;
}

.last-update .highlight {
  color: #60a5fa;
  font-weight: 600;
}

.hero-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1.5rem;
  margin-top: 2rem;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.hero-stat {
  background: linear-gradient(135deg, #1e293b80, #33415580);
  backdrop-filter: blur(10px);
  padding: 1.5rem;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.2);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.hero-stat::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, #60a5fa, #a855f7);
}

.hero-stat:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 40px rgba(96, 165, 250, 0.3);
}

.hero-stat-number {
  font-size: 1.8rem;
  font-weight: 800;
  margin-bottom: 0.25rem;
  display: block;
  text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.hero-stat-label {
  font-size: 0.8rem;
  opacity: 0.9;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.section {
  padding: 4rem 2rem;
  max-width: 1200px;
  margin: 0 auto;
}

.section-title {
  text-align: center;
  color: #f1f5f9;
  font-size: 2.2rem;
  margin-bottom: 3rem;
  position: relative;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.section-title::after {
  content: '';
  display: block;
  width: 80px;
  height: 4px;
  background: linear-gradient(90deg, #60a5fa, #a855f7);
  margin: 12px auto;
  border-radius: 2px;
}

.cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 2rem;
  margin-top: 2rem;
}

.card {
  background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
  padding: 2rem;
  border-radius: 24px;
  box-shadow: 0 10px 35px rgba(0,0,0,0.4);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid #374151;
  position: relative;
  overflow: hidden;
  cursor: pointer;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 6px;
  background: linear-gradient(90deg, #60a5fa, #a855f7);
}

.card:hover {
  transform: translateY(-10px) scale(1.03);
  box-shadow: 0 25px 50px rgba(96, 165, 250, 0.3);
  border-color: #60a5fa;
}

.card h3 {
  color: #f1f5f9;
  font-size: 1.4rem;
  margin-bottom: 1rem;
  font-weight: 600;
  text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.card p {
  color: #cbd5e1;
  line-height: 1.6;
  font-size: 0.95rem;
}

.card-badge {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: linear-gradient(135deg, #ef4444, #dc2626);
  color: white;
  padding: 0.3rem 0.8rem;
  border-radius: 20px;
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
  animation: pulse 2s infinite;
  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.counters-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 2rem;
  margin-top: 2rem;
}

.counter-item {
  background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
  padding: 2rem 1.5rem;
  border-radius: 24px;
  text-align: center;
  box-shadow: 0 10px 35px rgba(0,0,0,0.4);
  transition: all 0.4s ease;
  border: 1px solid #374151;
  position: relative;
  overflow: hidden;
}

.counter-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 6px;
  background: linear-gradient(90deg, #60a5fa, #a855f7);
}

.counter-item:hover {
  transform: translateY(-8px);
  box-shadow: 0 20px 45px rgba(96, 165, 250, 0.3);
  border-color: #60a5fa;
}

.counter-number {
  font-size: 3rem;
  font-weight: 800;
  color: #f1f5f9;
  margin-bottom: 0.5rem;
  display: block;
  transition: all 0.3s ease;
  text-shadow: 0 2px 8px rgba(0,0,0,0.5);
}

.counter-label {
  color: #cbd5e1;
  font-weight: 600;
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.alert-banner {
  background: linear-gradient(135deg, #fef3c7, #f59e0b);
  border: 1px solid #f59e0b;
  color: #92400e;
  padding: 1rem 2rem;
  border-radius: 12px;
  margin: 2rem 0;
  display: flex;
  align-items: center;
  gap: 1rem;
  animation: slideIn 0.5s ease-out;
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.alert-banner.hidden {
  display: none;
}

.emergency-btn {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 70px;
  height: 70px;
  background: linear-gradient(135deg, #ef4444, #dc2626);
  color: white;
  border: none;
  border-radius: 50%;
  font-size: 1.8rem;
  cursor: pointer;
  box-shadow: 0 8px 25px rgba(239, 68, 68, 0.6);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 1001;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: pulse-emergency 2s infinite;
}

.emergency-btn:hover {
  transform: scale(1.15) rotate(10deg);
  box-shadow: 0 12px 35px rgba(239, 68, 68, 0.8);
}

@keyframes pulse-emergency {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(15, 23, 42, 0.9);
  backdrop-filter: blur(5px);
  z-index: 2000;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: linear-gradient(135deg, #1e293b, #334155);
  padding: 2rem;
  border-radius: 20px;
  max-width: 400px;
  width: 90%;
  text-align: center;
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
  border: 2px solid #60a5fa;
  animation: modalSlideIn 0.3s ease;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.modal h3 {
  color: #f1f5f9;
  margin-bottom: 1rem;
  font-size: 1.5rem;
}

.modal p {
  color: #cbd5e1;
  margin-bottom: 2rem;
  line-height: 1.5;
}

.github-login-btn {
  background: linear-gradient(135deg, #333, #000);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 12px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  width: 100%;
  margin-bottom: 1rem;
}

.github-login-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
}

.close-modal {
  background: linear-gradient(135deg, #64748b, #475569);
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.3s ease;
}

.close-modal:hover {
  background: linear-gradient(135deg, #475569, #374151);
}

.user-info {
  display: flex;
  align-items: center;
  gap: 10px;
  background: rgba(96, 165, 250, 0.2);
  padding: 8px 16px;
  border-radius: 25px;
  border: 1px solid #60a5fa;
}

.user-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: 2px solid #60a5fa;
}

.user-name {
  color: white;
  font-weight: 600;
  font-size: 0.9rem;
}

.logout-btn {
  background: none;
  border: none;
  color: #ef4444;
  cursor: pointer;
  font-size: 1.2rem;
  margin-left: 8px;
}

.logout-btn:hover {
  color: #dc2626;
}

.footer {
  background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
  color: #cbd5e1;
  text-align: center;
  padding: 3rem 2rem;
  margin-top: 4rem;
  border-top: 3px solid #60a5fa;
}

.footer-content {
  max-width: 600px;
  margin: 0 auto;
}

.tour-overlay {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: linear-gradient(135deg, #1e293b, #334155);
  color: #f1f5f9;
  padding: 2rem;
  border-radius: 20px;
  max-width: 400px;
  width: 90%;
  z-index: 2000;
  box-shadow: 0 25px 50px rgba(0,0,0,0.5);
  border: 2px solid #60a5fa;
  display: none;
}

.tour-text {
  margin-bottom: 1.5rem;
  line-height: 1.5;
  font-size: 1rem;
  text-align: center;
}

.tour-buttons {
  display: flex;
  gap: 1rem;
  justify-content: center;
}

.tour-btn {
  padding: 0.8rem 1.5rem;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
  font-size: 0.9rem;
}

.tour-next {
  background: linear-gradient(135deg, #60a5fa, #3b82f6);
  color: white;
  box-shadow: 0 4px 15px rgba(96, 165, 250, 0.4);
}

.tour-close {
  background: linear-gradient(135deg, #94a3b8, #64748b);
  color: white;
  box-shadow: 0 4px 15px rgba(148, 163, 184, 0.4);
}

.tour-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(96, 165, 250, 0.6);
}

.highlight-element {
  position: relative;
  z-index: 1999;
}

.notification-toast {
  position: fixed;
  top: 100px;
  right: 30px;
  background: linear-gradient(135deg, #1e293b, #334155);
  padding: 1.5rem 2rem;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  border-left: 4px solid #60a5fa;
  z-index: 2001;
  transform: translateX(400px);
  transition: transform 0.3s ease;
  max-width: 300px;
  backdrop-filter: blur(10px);
}

.notification-toast.show {
  transform: translateX(0);
}

.notification-title {
  font-weight: 600;
  color: #f1f5f9;
  margin-bottom: 0.5rem;
}

.notification-message {
  color: #cbd5e1;
  font-size: 0.9rem;
}

@media (max-width: 768px) {
  .header {
    flex-direction: column;
    padding: 1rem;
    gap: 1rem;
  }
  
  .menu {
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .hero h1 {
    font-size: 2.2rem;
  }
  
  .hero p {
    font-size: 1.1rem;
  }
  
  .section {
    padding: 3rem 1rem;
  }
  
  .cards-grid {
    grid-template-columns: 1fr;
  }
  
  .emergency-btn {
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    font-size: 1.6rem;
  }

  .notification-toast {
    right: 20px;
    left: 20px;
    max-width: none;
  }

  .hero-stats {
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }

  .counters-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }
}

@media (max-width: 480px) {
  .hero {
    padding: 4rem 1rem 2rem;
  }
  
  .hero h1 {
    font-size: 1.8rem;
  }
  
  .section-title {
    font-size: 1.8rem;
  }
  
  .card {
    padding: 1.5rem;
  }

  .hero-stats {
    grid-template-columns: 1fr;
  }

  .counters-grid {
    grid-template-columns: 1fr;
  }
}

@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

.menu a:focus,
.emergency-btn:focus,
.tour-btn:focus,
.install-btn:focus,
.github-login-btn:focus {
  outline: 2px solid #60a5fa;
  outline-offset: 2px;
}
</style>
</head>
<body>

<header class="header">
  <div class="logo" id="githubLoginTrigger">
    <img src="logo.jpg" alt="Alerta Bolivia" class="logo-img">
    <span>üáßüá¥ Alerta Bolivia</span>
  </div>
  <nav class="menu">
    <a href="index.html" class="active">Inicio</a>
    <a href="educacion.html">Educaci√≥n</a>
    <a href="denuncias.html">Denuncias</a>
    <a href="mapa.html">Mapa</a>
    <a href="contactos.html">Contactos</a>
    <button class="install-btn" id="installButton">
      üì± Descargar app
    </button>
  </nav>
  <div id="userInfo" class="user-info" style="display: none;">
    <img id="userAvatar" class="user-avatar" src="" alt="Avatar">
    <span id="userName" class="user-name"></span>
    <button class="logout-btn" onclick="logout()">‚úï</button>
  </div>
</header>

<main>
  <section class="hero">
    <div class="hero-content">
      <h1>Protege tu comunidad ante desastres naturales</h1>
      <p>Accede a informaci√≥n actualizada, estad√≠sticas en tiempo real y recomendaciones para actuar ante emergencias en Bolivia. Tu seguridad es nuestra prioridad.</p>
      
      <div class="last-update">
        üîÑ √öltima actualizaci√≥n: <span class="highlight" id="lastUpdateTime">Cargando...</span>
      </div>
      
      <div class="hero-stats">
        <div class="hero-stat">
          <span class="hero-stat-number" id="hero-desastres">0</span>
          <span class="hero-stat-label">Desastres Monitoreados</span>
        </div>
        <div class="hero-stat">
          <span class="hero-stat-number" id="hero-comunidades">0</span>
          <span class="hero-stat-label">Comunidades Activas</span>
        </div>
        <div class="hero-stat">
          <span class="hero-stat-number" id="hero-tiempo">0s</span>
          <span class="hero-stat-label">Tiempo Respuesta</span>
        </div>
      </div>
    </div>
  </section>

  <div class="alert-banner hidden" id="alertBanner">
    <span>‚ö†Ô∏è</span>
    <div>
      <strong>Estado del Sistema:</strong>
      <span id="alertMessage">Todos los sistemas operativos normalmente</span>
    </div>
    <button onclick="document.getElementById('alertBanner').classList.add('hidden')" style="margin-left: auto; background: none; border: none; font-size: 1.2rem; cursor: pointer; color: #92400e;">√ó</button>
  </div>

  <section class="section">
    <h2 class="section-title">Tipos de Desastres y Medidas Preventivas</h2>
    <div class="cards-grid">
      <div class="card">
        <div class="card-badge">Activo</div>
        <h3>Sismos y Terremotos</h3>
        <p>Identifica zonas seguras en tu hogar, prepara un kit de emergencia y conoce las rutas de evacuaci√≥n establecidas por tu municipio.</p>
      </div>
      <div class="card">
        <h3>Inundaciones</h3>
        <p>Reconoce √°reas de riesgo hist√≥ricas, prepara suministros esenciales para 72 horas y mantente informado sobre alertas meteorol√≥gicas.</p>
      </div>
      <div class="card">
        <div class="card-badge">Alerta</div>
        <h3>Deslizamientos</h3>
        <p>Identifica se√±ales de alerta en laderas, evita construir en zonas de riesgo y sigue las recomendaciones de autoridades locales.</p>
      </div>
      <div class="card">
        <h3>Incendios Forestales</h3>
        <p>Conoce las medidas de prevenci√≥n, protocolos de contenci√≥n y evacuaci√≥n para proteger a tu familia y comunidad.</p>
      </div>
    </div>
  </section>

  <section class="section">
    <h2 class="section-title">Estad√≠sticas en Tiempo Real</h2>
    <div class="counters-grid">
      <div class="counter-item">
        <span class="counter-number" id="desastres">0</span>
        <span class="counter-label">Desastres Reportados</span>
      </div>
      <div class="counter-item">
        <span class="counter-number" id="denuncias">0</span>
        <span class="counter-label">Denuncias Recibidas</span>
      </div>
      <div class="counter-item">
        <span class="counter-number" id="comunidades">0</span>
        <span class="counter-label">Comunidades Alertadas</span>
      </div>
      <div class="counter-item">
        <span class="counter-number" id="activas">0</span>
        <span class="counter-label">Alertas Activas</span>
      </div>
    </div>
  </section>

  <section class="section">
    <h2 class="section-title">Acciones R√°pidas</h2>
    <div class="cards-grid">
      <div class="card" onclick="window.location.href='denuncias.html'" style="cursor: pointer;">
        <h3>üìù Reportar Incidente</h3>
        <p>Notifica inmediatamente sobre desastres o situaciones de riesgo en tu comunidad.</p>
      </div>
      <div class="card" onclick="window.location.href='mapa.html'" style="cursor: pointer;">
        <h3>üó∫Ô∏è Ver Mapa en Tiempo Real</h3>
        <p>Monitorea desastres activos y centros de emergencia en tu √°rea.</p>
      </div>
      <div class="card" onclick="window.location.href='educacion.html'" style="cursor: pointer;">
        <h3>üìö Gu√≠as de Emergencia</h3>
        <p>Aprende protocolos de seguridad y medidas preventivas para diferentes desastres.</p>
      </div>
    </div>
  </section>
</main>

<div class="modal" id="loginModal">
  <div class="modal-content">
    <h3>Iniciar Sesi√≥n</h3>
    <p>Accede con tu cuenta de GitHub para personalizar tu experiencia y guardar tus preferencias.</p>
    <button class="github-login-btn" onclick="loginWithGitHub()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
      </svg>
      Iniciar sesi√≥n con GitHub
    </button>
    <button class="close-modal" onclick="closeLoginModal()">Cancelar</button>
  </div>
</div>

<form id="emergency-form" action="https://formspree.io/f/xblzaejj" method="POST" style="display: none;">
  <input type="hidden" name="nombre" value="Alerta R√°pida">
  <input type="hidden" name="_replyto" value="usuario@correo.com">
  <input type="hidden" name="tipo" value="Emergencia">
  <input type="hidden" name="lugar" value="Mi comunidad">
  <input type="hidden" name="lat" value="-16.5">
  <input type="hidden" name="lon" value="-68.15">
  <textarea name="descripcion" style="display: none;">üö® Hay un desastre en mi comunidad. Se requiere intervenci√≥n inmediata de los servicios de emergencia.</textarea>
</form>

<button class="emergency-btn" title="Enviar alerta r√°pida de emergencia" aria-label="Bot√≥n de emergencia">
  üö®
</button>

<div class="tour-overlay" id="tourOverlay">
  <div class="tour-text" id="tourText"></div>
  <div class="tour-buttons">
    <button class="tour-btn tour-close" id="tourClose">Cerrar</button>
    <button class="tour-btn tour-next" id="tourNext">Siguiente</button>
  </div>
</div>

<div class="notification-toast" id="notificationToast">
  <div class="notification-title" id="toastTitle">Nueva Actualizaci√≥n</div>
  <div class="notification-message" id="toastMessage">El sistema se ha actualizado correctamente</div>
</div>

<footer class="footer">
  <div class="footer-content">
    <p>¬© 2025 Plataforma de Alerta y Educaci√≥n Ambiental de Bolivia</p>
    <p style="margin-top: 0.5rem; opacity: 0.8; font-size: 0.9rem;">Sistema de monitoreo y alerta temprana</p>
  </div>
</footer>

<script>
let deferredPrompt;

if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('service-worker.js')
      .then(function(registration) {
        console.log('Service Worker registrado con √©xito:', registration);
      })
      .catch(function(error) {
        console.log('Error al registrar el Service Worker:', error);
      });
  });
}

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  const installButton = document.getElementById('installButton');
  if (installButton) {
    installButton.style.display = 'flex';
  }
  console.log('PWA lista para instalaci√≥n');
});

document.getElementById('installButton').addEventListener('click', async () => {
  if (!deferredPrompt) {
    alert('Para instalar la app, busca la opci√≥n "Agregar a la pantalla de inicio" en el men√∫ de tu navegador.');
    return;
  }
  
  deferredPrompt.prompt();
  
  const { outcome } = await deferredPrompt.userChoice;
  
  if (outcome === 'accepted') {
    console.log('Usuario acept√≥ instalar la PWA');
    document.getElementById('installButton').classList.add('hidden');
    window.sistemaContadores.mostrarToast('¬°App Instalada!', 'La aplicaci√≥n se ha instalado correctamente en tu dispositivo.');
  } else {
    console.log('Usuario rechaz√≥ instalar la PWA');
  }
  
  deferredPrompt = null;
});

window.addEventListener('appinstalled', () => {
  console.log('PWA instalada');
  document.getElementById('installButton').classList.add('hidden');
  deferredPrompt = null;
});

window.addEventListener('load', () => {
  if (window.matchMedia('(display-mode: standalone)').matches) {
    console.log('La PWA ya est√° instalada');
    document.getElementById('installButton').classList.add('hidden');
  }
});

const GITHUB_CLIENT_ID = 'tu_client_id_aqui';
const GITHUB_REDIRECT_URI = window.location.origin + window.location.pathname;
const GITHUB_SCOPE = 'user:email';

document.getElementById('githubLoginTrigger').addEventListener('click', () => {
  const userInfo = document.getElementById('userInfo');
  
  if (userInfo.style.display === 'flex') {
    return;
  }
  
  document.getElementById('loginModal').style.display = 'flex';
});

function closeLoginModal() {
  document.getElementById('loginModal').style.display = 'none';
}

function loginWithGitHub() {
  const authUrl = `https://github.com/oauth/authorize?client_id=${GITHUB_CLIENT_ID}&redirect_uri=${encodeURIComponent(GITHUB_REDIRECT_URI)}&scope=${GITHUB_SCOPE}`;
  
  const width = 600;
  const height = 600;
  const left = (window.screen.width - width) / 2;
  const top = (window.screen.height - height) / 2;
  
  const authWindow = window.open(
    authUrl,
    'GitHub Login',
    `width=${width},height=${height},left=${left},top=${top}`
  );
  
  const checkAuthWindow = setInterval(() => {
    if (authWindow.closed) {
      clearInterval(checkAuthWindow);
      simulateUserData();
    }
  }, 500);
  
  closeLoginModal();
}

function simulateUserData() {
  const userData = {
    name: 'Usuario GitHub',
    avatar: 'https://avatars.githubusercontent.com/u/example?v=4',
    login: 'githubuser'
  };
  
  localStorage.setItem('githubUser', JSON.stringify(userData));
  updateUserUI(userData);
  window.sistemaContadores.mostrarToast('¬°Bienvenido!', `Has iniciado sesi√≥n como ${userData.name}`);
}

function updateUserUI(userData) {
  const userInfo = document.getElementById('userInfo');
  const userAvatar = document.getElementById('userAvatar');
  const userName = document.getElementById('userName');
  
  userAvatar.src = userData.avatar;
  userName.textContent = userData.name;
  userInfo.style.display = 'flex';
}

function logout() {
  localStorage.removeItem('githubUser');
  document.getElementById('userInfo').style.display = 'none';
  window.sistemaContadores.mostrarToast('Sesi√≥n cerrada', 'Has cerrado sesi√≥n correctamente');
}

window.addEventListener('load', () => {
  const savedUser = localStorage.getItem('githubUser');
  if (savedUser) {
    const userData = JSON.parse(savedUser);
    updateUserUI(userData);
  }
});

class SistemaContadoresAvanzado {
  constructor() {
    this.config = {
      baseDesastres: 127,
      baseDenuncias: 89,
      crecimientoDiario: 2.7,
      factorComunidades: 3.2,
      factorAlertas: 0.22
    };
    this.estadisticas = {};
    this.intervalos = {};
    this.cargarConfiguracion();
  }

  cargarConfiguracion() {
    const guardado = localStorage.getItem('sistemaContadores');
    if (guardado) {
      Object.assign(this.config, JSON.parse(guardado));
    }
  }

  guardarConfiguracion() {
    localStorage.setItem('sistemaContadores', JSON.stringify(this.config));
  }

  inicializar() {
    this.procesarDatosLocales();
    this.actualizarEstadisticasHero();
    this.actualizarContadoresPrincipales();
    this.iniciarMonitoreoEnTiempoReal();
    this.mostrarNotificacionInicial();
    this.actualizarFecha();
  }

  procesarDatosLocales() {
    const denunciasLocales = JSON.parse(localStorage.getItem('denuncias')) || [];
    if (denunciasLocales.length > 0) {
      this.config.baseDesastres += denunciasLocales.length;
      this.config.baseDenuncias += denunciasLocales.length;
      this.guardarConfiguracion();
      localStorage.removeItem('denuncias');
      this.mostrarToast('√âxito', `${denunciasLocales.length} denuncias locales procesadas`);
    }

    const ultimaVisita = localStorage.getItem('ultimaVisita');
    const ahora = new Date().toISOString();
    
    if (ultimaVisita) {
      const diasDesdeVisita = Math.floor((new Date(ahora) - new Date(ultimaVisita)) / (1000 * 60 * 60 * 24));
      if (diasDesdeVisita > 0) {
        this.config.baseDesastres += Math.floor(diasDesdeVisita * 1.5);
        this.config.baseDenuncias += Math.floor(diasDesdeVisita * 1.5);
      }
    }
    
    localStorage.setItem('ultimaVisita', ahora);
  }

  calcularEstadisticas() {
    const fechaInicio = new Date('2024-01-01');
    const ahora = new Date();
    const diasActivo = Math.max(1, Math.floor((ahora - fechaInicio) / (1000 * 60 * 60 * 24)));
    
    const crecimiento = Math.floor(diasActivo * this.config.crecimientoDiario);
    const variacion = Math.floor(Math.random() * 12) - 3;

    return {
      desastres: this.config.baseDesastres + crecimiento + variacion,
      denuncias: this.config.baseDenuncias + crecimiento + variacion + 18,
      comunidades: Math.floor((this.config.baseDesastres + crecimiento) / this.config.factorComunidades),
      activas: Math.floor((this.config.baseDesastres + crecimiento) * this.config.factorAlertas),
      tiempoRespuesta: Math.max(45, 120 - Math.floor(crecimiento / 10))
    };
  }

  actualizarEstadisticasHero() {
    const stats = this.calcularEstadisticas();
    this.animarValor('hero-desastres', stats.desastres, 1500);
    this.animarValor('hero-comunidades', stats.comunidades, 1500);
    this.animarValor('hero-tiempo', stats.tiempoRespuesta + 's', 1500);
  }

  actualizarContadoresPrincipales() {
    const stats = this.calcularEstadisticas();
    this.animarValor('desastres', stats.desastres, 2000);
    this.animarValor('denuncias', stats.denuncias, 2000);
    this.animarValor('comunidades', stats.comunidades, 2000);
    this.animarValor('activas', stats.activas, 2000);
  }

  animarValor(elementId, valorFinal, duracion) {
    const elemento = document.getElementById(elementId);
    if (!elemento) return;

    const valorTexto = elemento.textContent;
    let valorInicial = 0;
    
    const match = valorTexto.match(/\d+/);
    if (match) valorInicial = parseInt(match[0]);
    
    let valorFinalNum = valorFinal;
    let sufijo = '';
    if (typeof valorFinal === 'string') {
      const matchFinal = valorFinal.match(/(\d+)(\D*)/);
      if (matchFinal) {
        valorFinalNum = parseInt(matchFinal[1]);
        sufijo = matchFinal[2];
      }
    }

    const diferencia = valorFinalNum - valorInicial;
    const pasos = duracion / 16;
    const incremento = diferencia / pasos;
    
    let valorActual = valorInicial;
    let paso = 0;

    const animar = () => {
      paso++;
      valorActual += incremento;
      
      if (paso < pasos) {
        elemento.textContent = Math.floor(valorActual) + sufijo;
        requestAnimationFrame(animar);
      } else {
        elemento.textContent = valorFinal;
        
        if (typeof valorFinal === 'number') {
          elemento.style.color = '#4ade80';
          elemento.style.transform = 'scale(1.1)';
          setTimeout(() => {
            elemento.style.color = '#f1f5f9';
            elemento.style.transform = '';
          }, 600);
        }
      }
    };

    animar();
  }

  iniciarMonitoreoEnTiempoReal() {
    this.intervalos.principal = setInterval(() => {
      this.actualizarContadoresPrincipales();
    }, 120000);

    this.intervalos.hero = setInterval(() => {
      this.actualizarEstadisticasHero();
    }, 30000);

    this.intervalos.eventos = setInterval(() => {
      this.simularEventoAleatorio();
    }, 45000);

    this.intervalos.fecha = setInterval(() => {
      this.actualizarFecha();
    }, 30000);
  }

  simularEventoAleatorio() {
    const eventos = [
      { tipo: 'nueva_denuncia', mensaje: 'Nueva denuncia recibida', incremento: 1 },
      { tipo: 'alerta_activada', mensaje: 'Alerta activada en nueva comunidad', incremento: 0 },
      { tipo: 'actualizacion', mensaje: 'Sistema actualizado correctamente', incremento: 0 }
    ];

    const evento = eventos[Math.floor(Math.random() * eventos.length)];
    
    if (evento.incremento > 0) {
      this.config.baseDesastres += evento.incremento;
      this.config.baseDenuncias += evento.incremento;
      this.guardarConfiguracion();
    }

    this.mostrarToast('Actualizaci√≥n', evento.mensaje);
  }

  incrementarManual(cantidad = 1) {
    this.config.baseDesastres += cantidad;
    this.config.baseDenuncias += cantidad;
    this.guardarConfiguracion();
    this.actualizarContadoresPrincipales();
    this.mostrarToast('Registro', `${cantidad} nuevo(s) reporte(s) agregado(s)`);
  }

  mostrarNotificacionInicial() {
    setTimeout(() => {
      this.mostrarToast('Bienvenido', 'Sistema de monitoreo activo - Datos en tiempo real');
    }, 2000);
  }

  mostrarToast(titulo, mensaje) {
    const toast = document.getElementById('notificationToast');
    const titleElem = document.getElementById('toastTitle');
    const messageElem = document.getElementById('toastMessage');
    
    titleElem.textContent = titulo;
    messageElem.textContent = mensaje;
    
    toast.classList.add('show');
    
    setTimeout(() => {
      toast.classList.remove('show');
    }, 4000);
  }

  actualizarFecha() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('es-BO', {
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit'
    });
    const dateString = now.toLocaleDateString('es-BO', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
    document.getElementById('lastUpdateTime').textContent = `${dateString} ${timeString}`;
    document.getElementById('lastUpdate').textContent = new Date().toLocaleDateString('es-BO', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  }

  destruir() {
    Object.values(this.intervalos).forEach(interval => clearInterval(interval));
  }
}

class SistemaTour {
  constructor() {
    this.pasos = [
      { 
        selector: '.logo', 
        texto: 'Bienvenido a Alerta Bolivia. Plataforma de monitoreo de emergencias en tiempo real.' 
      },
      { 
        selector: '.hero-stats', 
        texto: 'Estad√≠sticas actualizadas: desastres monitoreados, comunidades activas y tiempo de respuesta.' 
      },
      { 
        selector: '.cards-grid', 
        texto: 'Informaci√≥n sobre tipos de desastres y medidas preventivas organizadas por categor√≠as.' 
      },
      { 
        selector: '.counters-grid', 
        texto: 'Contadores en tiempo real que se actualizan autom√°ticamente con datos del sistema.' 
      },
      { 
        selector: '.emergency-btn', 
        texto: 'Bot√≥n de emergencia para reportar situaciones cr√≠ticas de forma inmediata.' 
      }
    ];
    this.pasoActual = 0;
    this.inicializar();
  }

  inicializar() {
    if (!localStorage.getItem('tourCompletado')) {
      setTimeout(() => this.mostrarTour(), 3000);
    }
  }

  mostrarTour() {
    this.mostrarPaso(this.pasoActual);
  }

  mostrarPaso(indice) {
    const paso = this.pasos[indice];
    
    document.querySelectorAll('.highlight-element').forEach(el => {
      el.classList.remove('highlight-element');
    });

    const overlay = document.getElementById('tourOverlay');
    const texto = document.getElementById('tourText');
    
    texto.textContent = paso.texto;
    overlay.style.display = 'block';

    document.getElementById('tourNext').onclick = () => this.siguientePaso();
    document.getElementById('tourClose').onclick = () => this.finalizarTour();
  }

  siguientePaso() {
    this.pasoActual++;
    if (this.pasoActual >= this.pasos.length) {
      this.finalizarTour();
    } else {
      this.mostrarPaso(this.pasoActual);
    }
  }

  finalizarTour() {
    document.getElementById('tourOverlay').style.display = 'none';
    document.querySelectorAll('.highlight-element').forEach(el => {
      el.classList.remove('highlight-element');
    });
    localStorage.setItem('tourCompletado', 'true');
  }
}

document.addEventListener('DOMContentLoaded', function() {
  window.sistemaContadores = new SistemaContadoresAvanzado();
  window.sistemaTour = new SistemaTour();

  window.sistemaContadores.inicializar();

  const emergencyBtn = document.querySelector('.emergency-btn');
  emergencyBtn.addEventListener('click', function() {
    const confirmar = confirm(
      'üö® ALERTA DE EMERGENCIA\n\n' +
      '¬øEst√°s seguro de que quieres enviar una alerta de emergencia?\n\n' +
      'Esto notificar√° inmediatamente a los servicios de emergencia.\n' +
      'Solo usa esta funci√≥n en caso de peligro real e inmediato.'
    );
    
    if (confirmar) {
      const originalBackground = this.style.background;
      const originalText = this.textContent;
      
      this.style.background = '#f59e0b';
      this.textContent = '‚è≥';
      this.disabled = true;
      this.style.animation = 'none';
      
      setTimeout(() => {
        document.getElementById('emergency-form').submit();
        
        setTimeout(() => {
          this.style.background = originalBackground;
          this.textContent = 'üö®';
          this.disabled = false;
          this.style.animation = 'pulse-emergency 2s infinite';
          window.sistemaContadores.incrementarManual(1);
        }, 2000);
      }, 1000);
    }
  });

  const cards = document.querySelectorAll('.card');
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, observerOptions);

  cards.forEach((card, index) => {
    card.style.opacity = '0';
    card.style.transform = 'translateY(30px)';
    card.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
    observer.observe(card);
  });

  setTimeout(() => {
    window.sistemaContadores.mostrarToast('Sincronizaci√≥n', 'Datos actualizados con servidores remotos');
  }, 5000);
});

window.registrarNuevoReporte = function(cantidad = 1) {
  if (window.sistemaContadores) {
    window.sistemaContadores.incrementarManual(cantidad);
  }
};

window.addEventListener('beforeunload', function() {
  if (window.sistemaContadores) {
    window.sistemaContadores.destruir();
  }
});
</script>

</body>
</html>