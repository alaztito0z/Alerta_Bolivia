<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Denuncias - Alerta Bolivia</title>

<meta name="theme-color" content="#E6F7FF">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="description" content="Sistema de Denuncias del Alerta Bolivia - Reporta incidentes y emergencias">

 <link rel="icon" type="image/png" href="logo-192x192.png">
<link rel="apple-touch-icon" href="logo-192x192.png">

<link rel="manifest" href="./manifest.json">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@700;800;900&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<style>

  :root {
    --primary: #00B4D4;      
    --primary-dark: #0096B4; 
    --primary-light: #5AC8E8; 
    --secondary: #80D0FF;   
    --secondary-dark: #5AB8E0; 
    --accent: #FF6B8B;      
    --accent-dark: #E05070; 
    --success: #4CD964;    
    --success-dark: #38C050; 
    --warning: #FFB347; 
    --warning-dark: #E09B3D; 
    --danger: #FF6B6B;  
    --danger-dark: #E05050;  
    --dark: #0A1E32;     
    --darker: #051525;       
    --dark-light: #1E3A5F;   
    --light: #F0F9FF;    
    --light-dark: #D1E8F2;  
    --gray: #7A8AA3;        
    --gray-dark: #5A6A83;   
    --glass: rgba(255, 255, 255, 0.1);
    --glass-light: rgba(255, 255, 255, 0.15);
    --glass-border: rgba(0, 180, 212, 0.2);
    --neon-glow: 0 0 20px rgba(0, 180, 212, 0.3), 0 0 40px rgba(0, 180, 212, 0.15);
    --neon-glow-danger: 0 0 20px rgba(255, 107, 107, 0.3), 0 0 40px rgba(255, 107, 107, 0.15);
    --neon-glow-success: 0 0 20px rgba(76, 217, 100, 0.3), 0 0 40px rgba(76, 217, 100, 0.15);
    --shadow-lg: 0 20px 60px rgba(0, 20, 40, 0.2);
    --shadow-xl: 0 30px 80px rgba(0, 20, 40, 0.25);
    --transition-smooth: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    --transition-fast: all 0.2s ease;
    --border-radius: 20px;
    --border-radius-lg: 30px;
    --border-radius-sm: 12px;
  }
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    scroll-behavior: smooth;
    font-size: 16px;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #F0F9FF 0%, #E6F7FF 100%);
    color: var(--dark);
    line-height: 1.6;
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
  }

  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
      radial-gradient(circle at 20% 30%, rgba(0, 180, 212, 0.08) 0%, transparent 50%),
      radial-gradient(circle at 80% 70%, rgba(255, 107, 139, 0.04) 0%, transparent 50%),
      radial-gradient(circle at 40% 80%, rgba(128, 208, 255, 0.06) 0%, transparent 50%);
    z-index: -1;
    animation: backgroundPulse 20s ease-in-out infinite alternate;
  }

  @keyframes backgroundPulse {
    0% { opacity: 0.6; }
    100% { opacity: 0.8; }
  }
  .animated-title-section {
    height: 50vh;
    min-height: 350px;
    padding: 2rem;
    box-sizing: border-box;
    position: relative;
    margin: 2rem auto;
    max-width: 1200px;
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    box-shadow: var(--shadow-xl);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .animated-title-container {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    border-radius: var(--border-radius);
    backdrop-filter: blur(10px);
    background: rgba(255, 255, 255, 0.1);
    overflow: hidden;
  }

  .animated-title {
    font-family: 'Poppins', sans-serif;
    font-size: clamp(2.5rem, 6vw, 4.5rem);
    font-weight: 800;
    color: transparent;
    position: relative;
    cursor: pointer;
    text-align: center;
    width: 100%;
    height: 120px;
    overflow: hidden;
    padding: 0;
    margin: 0;
  }

  .animated-title span {
    display: block;
    position: absolute;
    width: 100%;
    height: 50%;
    overflow: visible;
  }

  .animated-title span:first-child {
    top: 0;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    z-index: 1;
  }

  .animated-title span:last-child {
    bottom: 0;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    z-index: 1;
  }

  .animated-title span:first-child::before,
  .animated-title span:last-child::before {
    content: attr(data-text);
    font-family: 'Poppins', sans-serif;
    font-weight: 800;
    font-size: clamp(2.5rem, 6vw, 4.5rem);
    transition: all 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    line-height: 1;
    white-space: nowrap;
    position: absolute;
    width: 100%;
  }

  .animated-title span:first-child::before {
    color: white;
    transform: translateX(0) translateY(0.4em);
  }

  .animated-title span:last-child::before {
    color: rgba(255, 255, 255, 0.7);
    transform: translateX(0) translateY(-0.6em);
  }

  .animated-title:hover span:first-child::before {
    transform: translateX(-30px) translateY(0.4em);
    transition-delay: 0.1s;
  }

  .animated-title:hover span:last-child::before {
    transform: translateX(30px) translateY(-0.6em);
    color: rgba(255, 255, 255, 0.5);
    transition-delay: 0.1s;
  }

  .animated-title:not(:hover) span:first-child::before {
    transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  .animated-title:not(:hover) span:last-child::before {
    transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275), color 0.4s ease;
  }
  .header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(0, 180, 212, 0.1);
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 1000;
    box-shadow: 0 4px 30px rgba(0, 20, 40, 0.1);
    transition: var(--transition-smooth);
  }

  .header.scrolled {
    padding: 0.75rem 2rem;
    background: rgba(255, 255, 255, 0.98);
  }

  .logo-container {
    display: flex;
    align-items: center;
    gap: 1rem;
    cursor: pointer;
    transition: var(--transition-smooth);
  }

  .logo-container:hover {
    transform: translateX(5px);
  }

  .logo-img {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    box-shadow: var(--neon-glow);
    animation: logoFloat 6s ease-in-out infinite;
    color: white;
  }

  @keyframes logoFloat {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    33% { transform: translateY(-5px) rotate(2deg); }
    66% { transform: translateY(3px) rotate(-1deg); }
  }

  .logo-text {
    display: flex;
    flex-direction: column;
  }

  .logo-title {
    font-family: 'Poppins', sans-serif;
    font-weight: 800;
    font-size: 1.5rem;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }

  .logo-subtitle {
    font-size: 0.8rem;
    color: var(--gray);
    font-weight: 500;
    letter-spacing: 1px;
    text-transform: uppercase;
  }
  .nav-menu {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }

  .nav-link {
    color: var(--dark);
    text-decoration: none;
    padding: 0.75rem 1.5rem;
    border-radius: 50px;
    transition: var(--transition-smooth);
    font-weight: 500;
    position: relative;
    overflow: hidden;
    border: 1px solid transparent;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.95rem;
  }

  .nav-link::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(0, 180, 212, 0.1), transparent);
    transition: left 0.6s ease;
  }

  .nav-link:hover::before {
    left: 100%;
  }

  .nav-link:hover {
    border-color: var(--primary);
    box-shadow: var(--neon-glow);
    transform: translateY(-2px);
    background: var(--glass-light);
  }

  .nav-link.active {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    box-shadow: var(--neon-glow);
    border: none;
  }

  .nav-link i {
    font-size: 1.1rem;
  }

  .main {
    padding: 8rem 2rem 3rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  .page-title {
    text-align: center;
    color: var(--dark);
    margin-bottom: 1rem;
    font-size: 2.5rem;
    font-weight: 800;
    position: relative;
    font-family: 'Poppins', sans-serif;
  }

  .page-title::after {
    content: '';
    display: block;
    width: 100px;
    height: 4px;
    background: linear-gradient(90deg, var(--primary), var(--secondary));
    margin: 1rem auto;
    border-radius: 2px;
    box-shadow: var(--neon-glow);
  }

  .last-update {
    text-align: center;
    color: var(--gray);
    font-size: 0.95rem;
    margin-bottom: 3rem;
  }

  .last-update .highlight {
    color: var(--primary);
    font-weight: 600;
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 3rem;
  }

  .stat-card {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: var(--border-radius);
    padding: 2rem;
    text-align: center;
    transition: var(--transition-smooth);
    position: relative;
    overflow: hidden;
  }

  .stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, var(--primary), var(--secondary));
  }

  .stat-card:hover {
    transform: translateY(-5px);
    border-color: var(--primary);
    box-shadow: var(--shadow-lg);
    background: white;
  }

  .stat-number {
    font-size: 2.5rem;
    font-weight: 900;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin-bottom: 0.5rem;
    display: block;
    line-height: 1;
  }

  .stat-label {
    font-size: 0.9rem;
    color: var(--gray);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
  }

  .form-container {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: var(--border-radius-lg);
    padding: 2.5rem;
    box-shadow: var(--shadow-lg);
    position: relative;
    overflow: hidden;
    margin-bottom: 3rem;
  }

  .form-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px;
    background: linear-gradient(90deg, var(--primary), var(--secondary));
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--dark);
    font-size: 1rem;
  }

  .form-input, .form-select, .form-textarea {
    width: 100%;
    padding: 0.8rem 1rem;
    border: 1px solid var(--glass-border);
    border-radius: var(--border-radius-sm);
    font-size: 1rem;
    background: rgba(255, 255, 255, 0.9);
    color: var(--dark);
    transition: var(--transition-smooth);
    font-family: 'Inter', sans-serif;
  }

  .form-input:focus, .form-select:focus, .form-textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: var(--neon-glow);
    background: white;
  }

  .form-textarea {
    min-height: 120px;
    resize: vertical;
    line-height: 1.5;
  }

  .coordinates-group {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  .location-actions {
    display: flex;
    gap: 1rem;
    margin-top: 0.5rem;
  }
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.9rem 2rem;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border: none;
    border-radius: var(--border-radius-sm);
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition-smooth);
    font-family: 'Inter', sans-serif;
  }

  .btn:hover {
    transform: translateY(-3px);
    box-shadow: var(--neon-glow);
  }

  .btn-secondary {
    background: rgba(255, 255, 255, 0.9);
    color: var(--dark);
    border: 1px solid var(--glass-border);
  }

  .btn-secondary:hover {
    background: white;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }

  .btn-full {
    width: 100%;
  }

  .btn-danger {
    background: linear-gradient(135deg, var(--danger), var(--accent-dark));
  }

  .btn-danger:hover {
    box-shadow: var(--neon-glow-danger);
  }
  .reports-section {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: var(--border-radius-lg);
    padding: 2.5rem;
    box-shadow: var(--shadow-lg);
    position: relative;
    margin-bottom: 2rem;
  }

  .reports-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px;
    background: linear-gradient(90deg, var(--danger), var(--accent-dark));
  }

  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .section-title {
    color: var(--dark);
    font-size: 1.8rem;
    font-weight: 700;
    margin: 0;
    font-family: 'Poppins', sans-serif;
  }

  .filter-controls {
    display: flex;
    gap: 1rem;
    align-items: center;
  }

  .filter-select {
    padding: 0.5rem 1rem;
    border: 1px solid var(--glass-border);
    border-radius: var(--border-radius-sm);
    background: rgba(255, 255, 255, 0.9);
    font-size: 0.9rem;
    color: var(--dark);
  }

  .reports-list {
    list-style: none;
    padding: 0;
  }

  .report-item {
    background: rgba(255, 255, 255, 0.5);
    padding: 1.5rem;
    margin-bottom: 1rem;
    border-radius: var(--border-radius);
    border-left: 4px solid var(--primary);
    transition: var(--transition-smooth);
    border: 1px solid var(--glass-border);
    position: relative;
  }

  .report-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
    border-color: var(--primary);
    background: white;
  }

  .report-item.emergency {
    border-left-color: var(--danger);
    background: rgba(255, 107, 107, 0.05);
  }

  .report-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .report-type {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
  }

  .report-type.emergency {
    background: linear-gradient(135deg, var(--danger), var(--accent-dark));
  }

  .report-location {
    color: var(--gray);
    font-size: 0.9rem;
    font-weight: 500;
  }

  .report-description {
    color: var(--dark-light);
    line-height: 1.5;
    margin-bottom: 0.5rem;
  }

  .report-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.8rem;
    color: var(--gray);
    margin-top: 0.5rem;
  }

  .report-priority {
    padding: 0.2rem 0.6rem;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
  }

  .priority-high {
    background: rgba(255, 107, 107, 0.1);
    color: var(--danger);
    border: 1px solid var(--danger);
  }

  .priority-medium {
    background: rgba(255, 179, 71, 0.1);
    color: var(--warning);
    border: 1px solid var(--warning);
  }

  .priority-low {
    background: rgba(76, 217, 100, 0.1);
    color: var(--success);
    border: 1px solid var(--success);
  }

  .empty-state {
    text-align: center;
    color: var(--gray);
    padding: 3rem;
    font-style: italic;
  }
  .emergency-btn {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    width: 70px;
    height: 70px;
    background: linear-gradient(135deg, var(--danger), var(--accent-dark));
    border: none;
    border-radius: 50%;
    font-size: 1.8rem;
    color: white;
    cursor: pointer;
    z-index: 1001;
    box-shadow: var(--neon-glow-danger);
    transition: var(--transition-smooth);
    display: flex;
    align-items: center;
    justify-content: center;
    animation: emergencyPulse 2s infinite;
  }

  @keyframes emergencyPulse {
    0%, 100% { 
      transform: scale(1);
      box-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
    }
    50% { 
      transform: scale(1.1);
      box-shadow: 0 15px 40px rgba(255, 107, 107, 0.4), 0 0 60px rgba(255, 107, 107, 0.3);
    }
  }

  .emergency-btn:hover {
    transform: scale(1.2) rotate(15deg);
    animation: none;
  }
  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(5, 21, 37, 0.95);
    backdrop-filter: blur(20px);
    z-index: 2000;
    align-items: center;
    justify-content: center;
    padding: 1rem;
  }

  .modal-content {
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 180, 212, 0.2);
    border-radius: var(--border-radius-lg);
    padding: 3rem;
    max-width: 500px;
    width: 100%;
    box-shadow: var(--shadow-xl);
    animation: modalAppear 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
    color: var(--dark);
  }

  @keyframes modalAppear {
    from {
      opacity: 0;
      transform: scale(0.8) translateY(50px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }

  .modal-content::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent));
    border-radius: calc(var(--border-radius-lg) + 2px);
    z-index: -1;
    animation: modalBorderGlow 3s linear infinite;
  }

  @keyframes modalBorderGlow {
    0% { filter: hue-rotate(0deg); }
    100% { filter: hue-rotate(360deg); }
  }

  .modal-title {
    font-size: 1.8rem;
    color: var(--dark);
    margin-bottom: 0.5rem;
    font-family: 'Poppins', sans-serif;
  }

  .modal-subtitle {
    color: var(--gray);
    font-size: 1rem;
  }

  .modal-body {
    margin-bottom: 2rem;
  }

  .modal-text {
    color: var(--dark-light);
    line-height: 1.6;
    margin-bottom: 1.5rem;
  }

  .emergency-modal {
    max-width: 450px;
  }

  .location-status {
    background: rgba(255, 255, 255, 0.5);
    padding: 1rem;
    border-radius: var(--border-radius-sm);
    margin: 1rem 0;
    border: 1px solid var(--glass-border);
  }

  .emergency-info {
    background: rgba(255, 255, 255, 0.5);
    padding: 1rem;
    border-radius: var(--border-radius-sm);
    margin: 1rem 0;
    border-left: 4px solid var(--danger);
    text-align: left;
  }

  .emergency-info h4 {
    color: var(--danger);
    margin-bottom: 0.5rem;
  }

  .emergency-info ul {
    color: var(--dark-light);
    font-size: 0.9rem;
    padding-left: 1rem;
  }


  .notification-toast {
    position: fixed;
    top: 100px;
    right: 30px;
    background: rgba(255, 255, 255, 0.95);
    padding: 1.5rem 2rem;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-xl);
    border-left: 4px solid var(--primary);
    z-index: 2001;
    transform: translateX(400px);
    transition: transform 0.3s ease;
    max-width: 300px;
    backdrop-filter: blur(10px);
  }

  .notification-toast.show {
    transform: translateX(0);
  }

  .notification-title {
    font-weight: 700;
    color: var(--dark);
    margin-bottom: 0.5rem;
    font-size: 1.1rem;
  }

  .notification-message {
    color: var(--dark-light);
    font-size: 0.95rem;
  }
  .alert-banner {
    background: rgba(255, 179, 71, 0.1);
    border: 1px solid rgba(255, 179, 71, 0.3);
    color: var(--warning-dark);
    padding: 1.25rem 2rem;
    margin: 2rem auto 3rem;
    border-radius: var(--border-radius-sm);
    max-width: 1200px;
    display: flex;
    align-items: center;
    gap: 1rem;
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
    background-color: rgba(255, 255, 255, 0.8);
  }

  .alert-banner::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 5px;
    height: 100%;
    background: var(--warning);
  }

  .alert-banner.hidden {
    display: none;
  }
  .map-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(5, 21, 37, 0.95);
    backdrop-filter: blur(20px);
    z-index: 3000;
    padding: 20px;
  }

  .map-modal-content {
    background: rgba(255, 255, 255, 0.95);
    border-radius: var(--border-radius-lg);
    border: 1px solid var(--glass-border);
    height: 100%;
    display: flex;
    flex-direction: column;
    position: relative;
  }

  .map-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--glass-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
  }

  .map-container {
    flex: 1;
    min-height: 0;
    position: relative;
  }

  #map {
    width: 100%;
    height: 100%;
    border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
  }

  .map-footer {
    padding: 1rem 1.5rem;
    border-top: 1px solid var(--glass-border);
    background: rgba(255, 255, 255, 0.5);
    flex-shrink: 0;
  }

  .location-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
  }

  .location-text {
    flex: 1;
  }

  .location-text .form-label {
    margin-bottom: 0.25rem;
  }

  #selectedLocation {
    color: var(--primary);
    font-weight: 600;
    font-size: 0.95rem;
  }
  .loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(5, 21, 37, 0.9);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 4000;
    flex-direction: column;
    gap: 1rem;
  }

  .loading-spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255, 255, 255, 0.2);
    border-top: 5px solid var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  .location-accuracy {
    font-size: 0.8rem;
    color: var(--gray);
    margin-top: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .accuracy-high {
    color: var(--success);
  }

  .accuracy-medium {
    color: var(--warning);
  }

  .accuracy-low {
    color: var(--danger);
  }
  .footer {
    background: linear-gradient(135deg, #E6F7FF, #D1E8F2);
    border-top: 1px solid rgba(0, 180, 212, 0.2);
    padding: 3rem 2rem 2rem;
    margin-top: 4rem;
  }

  .footer-content {
    max-width: 1200px;
    margin: 0 auto;
    text-align: center;
  }

  .footer p {
    color: var(--dark);
    margin-bottom: 0.5rem;
  }

  .footer p:last-child {
    opacity: 0.8;
    font-size: 0.9rem;
  }
  @media (max-width: 1200px) {
    .page-title { font-size: 2.2rem; }
    .main { padding: 7rem 2rem 3rem; }
    .animated-title-section { height: 45vh; }
  }

  @media (max-width: 992px) {
    .header {
      flex-direction: column;
      gap: 1rem;
      padding: 1rem;
    }
    
    .nav-menu {
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .emergency-btn {
      bottom: 1.5rem;
      right: 1.5rem;
      width: 60px;
      height: 60px;
      font-size: 1.6rem;
    }
    
    .animated-title-section { height: 40vh; }
    .animated-title span:first-child::before {
      transform: translateX(-20px) translateY(0.4em);
    }
    .animated-title span:last-child::before {
      transform: translateX(20px) translateY(-0.6em);
    }
    .animated-title:hover span:first-child::before {
      transform: translateX(0) translateY(0.4em);
    }
    .animated-title:hover span:last-child::before {
      transform: translateX(0) translateY(-0.6em);
    }
  }

  @media (max-width: 768px) {
    .page-title { font-size: 2rem; }
    .main { padding: 6rem 1rem 2rem; }
    
    .form-container, .reports-section {
      padding: 2rem 1.5rem;
    }
    
    .coordinates-group {
      grid-template-columns: 1fr;
    }
    
    .section-header {
      flex-direction: column;
      align-items: stretch;
    }

    .filter-controls {
      justify-content: space-between;
    }

    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .location-actions {
      flex-direction: column;
    }

    .notification-toast {
      right: 20px;
      left: 20px;
      max-width: none;
    }
    
    .animated-title-section { 
      height: 35vh; 
      padding: 1rem;
      min-height: 300px;
    }
    .animated-title span:first-child::before {
      transform: translateX(-15px) translateY(0.4em);
    }
    .animated-title span:last-child::before {
      transform: translateX(15px) translateY(-0.6em);
    }
    .animated-title:hover span:first-child::before {
      transform: translateX(0) translateY(0.4em);
    }
    .animated-title:hover span:last-child::before {
      transform: translateX(0) translateY(-0.6em);
    }
  }

  @media (max-width: 480px) {
    .page-title { font-size: 1.8rem; }
    
    .form-container, .reports-section {
      padding: 1.5rem;
    }
    
    .report-header {
      flex-direction: column;
      align-items: flex-start;
    }

    .stats-grid {
      grid-template-columns: 1fr;
    }

    .location-actions {
      flex-direction: column;
    }

    .filter-controls {
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .animated-title-section { 
      height: 30vh; 
      min-height: 250px;
    }
    .animated-title span:first-child::before {
      transform: translateX(-10px) translateY(0.4em);
    }
    .animated-title span:last-child::before {
      transform: translateX(10px) translateY(-0.6em);
    }
    .animated-title:hover span:first-child::before {
      transform: translateX(0) translateY(0.4em);
    }
    .animated-title:hover span:last-child::before {
      transform: translateX(0) translateY(-0.6em);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
  :focus-visible {
    outline: 2px solid var(--primary);
    outline-offset: 4px;
  }
  ::-webkit-scrollbar {
    width: 10px;
  }

  ::-webkit-scrollbar-track {
    background: #E6F7FF;
  }

  ::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    border-radius: 5px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, var(--primary-light), var(--secondary-dark));
  }

  .leaflet-container {
    background: rgba(255, 255, 255, 0.9) !important;
  }

  .leaflet-popup-content-wrapper {
    background: rgba(255, 255, 255, 0.95) !important;
    color: var(--dark) !important;
    border: 1px solid var(--glass-border) !important;
    border-radius: var(--border-radius-sm) !important;
  }

  .leaflet-popup-tip {
    background: rgba(255, 255, 255, 0.95) !important;
  }
</style>
</head>
<body>

<header class="header" id="header">
  <div class="logo-container" onclick="window.location.href='index.html'">
    <div class="logo-img">
    <img src="logo.jpg" alt="Alerta Bolivia" style="width: 100%; height: 100%; object-fit: cover; border-radius: 12px;">
</div>
    <div class="logo-text">
      <div class="logo-title">Alerta Bolivia</div>
      <div class="logo-subtitle">Sistema de Denuncias</div>
    </div>
  </div>
  
  <nav class="nav-menu">
    <a href="index.html" class="nav-link">
      <i class="fas fa-home"></i> Inicio
    </a>
    <a href="educacion.html" class="nav-link">
      <i class="fas fa-graduation-cap"></i> Educaci√≥n
    </a>
    <a href="denuncias.html" class="nav-link active">
      <i class="fas fa-exclamation-triangle"></i> Denuncias
    </a>
    <a href="mapa.html" class="nav-link">
      <i class="fas fa-map-marked-alt"></i> Mapa
    </a>
    <a href="contactos.html" class="nav-link">
      <i class="fas fa-phone-alt"></i> Contactos
    </a>
  </nav>
</header>

<main class="main">
  <section class="animated-title-section">
    <article class="animated-title-container">
      <h1 class="animated-title">
        <span data-text="Sistema de Denuncias"></span>
        <span data-text="Sistema de Denuncias"></span>
      </h1>
    </article>
  </section>
  
  <div class="last-update">
    <i class="fas fa-sync-alt"></i> √öltima actualizaci√≥n: 
    <span class="highlight" id="lastUpdateTime">Cargando...</span>
  </div>
  <!--<div class="alert-banner hidden" id="alertBanner">
    <span class="alert-icon"><i class="fas fa-info-circle"></i></span>
    <div class="alert-content">
      <div class="alert-title">Estado del Sistema</div>
      <div class="alert-message" id="alertMessage">
        Sistema de denuncias operativo ‚Ä¢ √öltima actualizaci√≥n: <span id="lastUpdate"></span>
      </div>
    </div>
    <button class="alert-close" onclick="document.getElementById('alertBanner').classList.add('hidden')">
      <i class="fas fa-times"></i>
    </button>
  </div>-->
  <div class="stats-grid">
    <div class="stat-card">
      <span class="stat-number" id="total-reports">0</span>
      <span class="stat-label">Reportes Totales</span>
    </div>
    <div class="stat-card">
      <span class="stat-number" id="today-reports">0</span>
      <span class="stat-label">Reportes Hoy</span>
    </div>
    <div class="stat-card">
      <span class="stat-number" id="emergency-reports">0</span>
      <span class="stat-label">Emergencias</span>
    </div>
    <div class="stat-card">
      <span class="stat-number" id="response-time">30min</span>
      <span class="stat-label">Tiempo Respuesta</span>
    </div>
  </div>
  <section class="form-container">
    <form id="report-form">
      <div class="form-group">
        <label class="form-label">
          <i class="fas fa-user"></i> Nombre completo
        </label>
        <input type="text" name="nombre" class="form-input" placeholder="Ingresa tu nombre completo" required>
      </div>

      <div class="form-group">
        <label class="form-label">
          <i class="fas fa-envelope"></i> Correo electr√≥nico
        </label>
        <input type="email" name="_replyto" class="form-input" placeholder="tu.correo@ejemplo.com" required>
      </div>

      <div class="form-group">
        <label class="form-label">
          <i class="fas fa-exclamation-circle"></i> Tipo de incidente
        </label>
        <select name="tipo" class="form-select" required>
          <option value="">Selecciona el tipo de incidente</option>
          <option value="sismo">Sismo / Terremoto</option>
          <option value="inundacion">Inundaci√≥n</option>
          <option value="deslizamiento">Deslizamiento de tierra</option>
          <option value="incendio">Incendio forestal o urbano</option>
          <option value="emergencia">Emergencia m√©dica</option>
          <option value="otro">Otro tipo de emergencia</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">
          <i class="fas fa-bell"></i> Nivel de urgencia
        </label>
        <select name="urgencia" class="form-select" required>
          <option value="baja">Baja - Situaci√≥n controlada</option>
          <option value="media" selected>Media - Requiere atenci√≥n</option>
          <option value="alta">Alta - Necesita intervenci√≥n inmediata</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">
          <i class="fas fa-map-marker-alt"></i> Ubicaci√≥n del incidente
        </label>
        <input type="text" name="lugar" class="form-input" placeholder="Ej: La Paz - Zona Sur, Calle Principal #123" required id="lugar-input">
        <div class="location-actions">
          <button type="button" class="btn btn-secondary" onclick="obtenerUbicacionActual()">
            <i class="fas fa-location-arrow"></i> Obtener ubicaci√≥n actual
          </button>
          <button type="button" class="btn btn-secondary" onclick="abrirMapa()">
            <i class="fas fa-map"></i> Seleccionar en mapa
          </button>
        </div>
        <div class="location-accuracy" id="locationAccuracy" style="display: none;">
          <span>Precisi√≥n: </span>
          <span id="accuracyValue">-</span>
          <span>metros</span>
        </div>
      </div>

      <div class="form-group coordinates-group">
        <div>
          <label class="form-label">
            <i class="fas fa-globe-americas"></i> Latitud
          </label>
          <input type="number" step="0.000001" name="lat" class="form-input" placeholder="-16.500000" id="lat-input">
        </div>
        <div>
          <label class="form-label">
            <i class="fas fa-globe-americas"></i> Longitud
          </label>
          <input type="number" step="0.000001" name="lon" class="form-input" placeholder="-68.150000" id="lon-input">
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">
          <i class="fas fa-file-alt"></i> Descripci√≥n detallada
        </label>
        <textarea name="descripcion" class="form-textarea" placeholder="Describe con detalle lo sucedido, la gravedad de la situaci√≥n y cualquier informaci√≥n relevante..." required></textarea>
      </div>

      <button type="submit" class="btn btn-full">
        <i class="fas fa-paper-plane"></i> Enviar Reporte
      </button>
    </form>
  </section>
  <section class="reports-section">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-history"></i> Reportes Recientes
      </h2>
      <div class="filter-controls">
        <select class="filter-select" id="type-filter">
          <option value="all">Todos los tipos</option>
          <option value="sismo">Sismos</option>
          <option value="inundacion">Inundaciones</option>
          <option value="deslizamiento">Deslizamientos</option>
          <option value="incendio">Incendios</option>
          <option value="emergencia">Emergencias</option>
        </select>
        <select class="filter-select" id="urgency-filter">
          <option value="all">Todas las urgencias</option>
          <option value="alta">Alta urgencia</option>
          <option value="media">Media urgencia</option>
          <option value="baja">Baja urgencia</option>
        </select>
      </div>
    </div>
    <ul class="reports-list" id="report-list">
      <li class="empty-state">No hay reportes guardados localmente</li>
    </ul>
  </section>
</main>
<div class="modal" id="emergencyModal">
  <div class="modal-content emergency-modal">
    <div class="modal-header">
      <h3 class="modal-title">üö® ALERTA R√ÅPIDA DE EMERGENCIA</h3>
      <p class="modal-subtitle">Solo usar en situaciones reales de peligro</p>
    </div>
    
    <div class="modal-body">
      <p class="modal-text">
        Esta alerta notificar√° inmediatamente a los servicios de emergencia. Solo √∫sala en caso de peligro real.
      </p>
      
      <div class="location-status" id="locationStatus">
        <p><i class="fas fa-map-marker-alt"></i> Obteniendo tu ubicaci√≥n...</p>
      </div>
      
      <div class="emergency-info">
        <h4><i class="fas fa-info-circle"></i> Informaci√≥n que se enviar√°:</h4>
        <ul>
          <li><strong>Tipo:</strong> EMERGENCIA CR√çTICA</li>
          <li><strong>Gravedad:</strong> ROJO</li>
          <li><strong>Descripci√≥n:</strong> "üö® EMERGENCIA - Se requiere auxilio inmediato"</li>
          <li><strong>Ubicaci√≥n:</strong> <span id="locationPreview">Tu ubicaci√≥n actual</span></li>
          <li><strong>Destinos:</strong> Formspree + WhatsApp con Google Maps</li>
        </ul>
      </div>
    </div>
    
    <div class="modal-actions">
      <button class="btn btn-danger btn-full" id="sendEmergencyBtn" onclick="enviarAlertaRapida()" disabled>
        <i class="fas fa-paper-plane"></i> ENVIAR ALERTA DE EMERGENCIA
      </button>
      <button class="btn btn-secondary btn-full" onclick="closeEmergencyModal()" style="margin-top: 1rem;">
        Cancelar
      </button>
    </div>
  </div>
</div>
<form id="emergencyFormspreeForm" action="https://formspree.io/f/xblzaejj" method="POST" style="display: none;">
  <input type="hidden" name="_subject" value="üö® ALERTA R√ÅPIDA - Alerta Bolivia">
  <input type="hidden" name="tipo" value="EMERGENCIA CR√çTICA">
  <input type="hidden" name="gravedad" value="CRITICA">
  <input type="hidden" name="descripcion" value="üö® ALERTA: Situaci√≥n de emergencia que requiere intervenci√≥n inmediata de servicios de emergencia">
  <input type="hidden" name="ubicacion" id="formspreeUbicacion" value="">
  <input type="hidden" name="timestamp" id="formspreeTimestamp" value="">
  <input type="hidden" name="fuente" value="Alerta Bolivia Web App">
</form>
<button class="emergency-btn" title="Enviar alerta r√°pida de emergencia" aria-label="Bot√≥n de emergencia" onclick="mostrarAlertaRapida()">
  <i class="fas fa-exclamation-triangle"></i>
</button>
<div class="notification-toast" id="notificationToast">
  <div class="notification-title" id="toastTitle">Reporte Enviado</div>
  <div class="notification-message" id="toastMessage">Tu reporte ha sido registrado correctamente</div>
</div>
<div class="map-modal" id="mapModal">
  <div class="map-modal-content">
    <div class="map-header">
      <h3 style="margin: 0; color: var(--dark); font-size: 1.5rem;">
        <i class="fas fa-map"></i> Seleccionar Ubicaci√≥n
      </h3>
      <button type="button" class="btn btn-danger" onclick="cerrarMapa()" style="padding: 0.7rem 1.5rem;">
        <i class="fas fa-times"></i> Cerrar
      </button>
    </div>
    
    <div class="map-container">
      <div id="map"></div>
    </div>
    
    <div class="map-footer">
      <div class="location-info">
        <div class="location-text">
          <div class="form-label">Ubicaci√≥n seleccionada:</div>
          <div id="selectedLocation">Haz clic en el mapa para seleccionar una ubicaci√≥n</div>
        </div>
        <button type="button" class="btn confirm-btn" onclick="confirmarUbicacion()" id="confirmBtn" style="padding: 0.8rem 1.5rem;" disabled>
          <i class="fas fa-check"></i> Confirmar
        </button>
      </div>
    </div>
  </div>
</div>
<div class="loading-overlay" id="loadingOverlay" style="display: none;">
  <div class="loading-spinner"></div>
  <p style="color: var(--light); font-size: 1.1rem;">Obteniendo ubicaci√≥n precisa...</p>
  <p style="color: var(--gray); font-size: 0.9rem;">Esto puede tomar unos segundos</p>
</div>
<footer class="footer">
  <div class="footer-content">
    <p>¬© 2026 SAT Bolivia - Sistema de Alerta Temprana. Todos los derechos reservados.</p>
    <p>Desarrollado con <i class="fas fa-heart" style="color: var(--danger);"></i> para proteger a Bolivia</p>
  </div>
</footer>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js').catch(err => {
        console.log('ServiceWorker registration failed: ', err);
      });
    });
  }
</script>
<script>
  let mapa = null;
  let marcador = null;
  let coordenadasSeleccionadas = null;
  let direccionSeleccionada = '';
  let ubicacionUsuario = null;

  class SistemaDenuncias {
    constructor() {
      this.reports = [];
      this.filters = {
        type: 'all',
        urgency: 'all'
      };
      this.cargarReportes();
      this.inicializar();
    }

    cargarReportes() {
      this.reports = JSON.parse(localStorage.getItem('sat_denuncias')) || [];
    }

    guardarReportes() {
      localStorage.setItem('sat_denuncias', JSON.stringify(this.reports));
    }

    inicializar() {
      this.actualizarEstadisticas();
      this.configurarFormulario();
      this.configurarFiltros();
      this.cargarReportesLista();
      this.actualizarFecha();
      this.configurarEventos();
      setTimeout(() => {
        //this.mostrarNotificacion('üö® Sistema de Denuncias', 'Reporta incidentes y emergencias en tiempo real');
      }, 1500);
    }

    configurarEventos() {
      window.addEventListener('scroll', () => {
        const header = document.getElementById('header');
        if (window.scrollY > 50) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      });

      setInterval(() => this.actualizarFecha(), 60000);
    }

    actualizarEstadisticas() {
      const total = this.reports.length;
      const hoy = this.reports.filter(r => this.esHoy(r.timestamp)).length;
      const emergencias = this.reports.filter(r => r.urgencia === 'alta').length;
      
      document.getElementById('total-reports').textContent = total;
      document.getElementById('today-reports').textContent = hoy;
      document.getElementById('emergency-reports').textContent = emergencias;
    }

    esHoy(timestamp) {
      const fechaReporte = new Date(timestamp);
      const hoy = new Date();
      return fechaReporte.toDateString() === hoy.toDateString();
    }

    actualizarFecha() {
      const now = new Date();
      const timeString = now.toLocaleTimeString('es-BO', {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      });
      const dateString = now.toLocaleDateString('es-BO', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
      document.getElementById('lastUpdateTime').textContent = `${dateString} ${timeString}`;
      const lastUpdate = document.getElementById('lastUpdate');
      if (lastUpdate) {
        lastUpdate.textContent = `${dateString} ${timeString}`;
      }
    }

    configurarFormulario() {
      const form = document.getElementById('report-form');
      form.addEventListener('submit', (e) => this.enviarReporte(e));
    }

    configurarFiltros() {
      document.getElementById('type-filter').addEventListener('change', (e) => {
        this.filters.type = e.target.value;
        this.cargarReportesLista();
      });

      document.getElementById('urgency-filter').addEventListener('change', (e) => {
        this.filters.urgency = e.target.value;
        this.cargarReportesLista();
      });
    }

    async enviarReporte(e) {
      e.preventDefault();
      
      const formData = new FormData(e.target);
      const reporte = {
        nombre: formData.get('nombre'),
        tipo: formData.get('tipo'),
        urgencia: formData.get('urgencia'),
        lugar: formData.get('lugar'),
        lat: formData.get('lat'),
        lon: formData.get('lon'),
        descripcion: formData.get('descripcion'),
        timestamp: new Date().toISOString(),
        id: Date.now().toString()
      };

      this.reports.push(reporte);
      this.guardarReportes();
      
      await this.enviarAFormspree(reporte);
      
      this.mostrarNotificacion('‚úÖ Reporte Enviado', 'Tu reporte ha sido registrado correctamente');
      this.actualizarEstadisticas();
      this.cargarReportesLista();
      e.target.reset();
    }

    agregarDenunciaRapida(alertaData) {
      const reporte = {
        nombre: alertaData.usuario || "Usuario An√≥nimo",
        tipo: "emergencia",
        urgencia: "alta",
        lugar: alertaData.ubicacion.lat ? 
          `Lat: ${alertaData.ubicacion.lat.toFixed(4)}, Lon: ${alertaData.ubicacion.lng.toFixed(4)}` : 
          "Ubicaci√≥n no disponible",
        lat: alertaData.ubicacion.lat || "",
        lon: alertaData.ubicacion.lng || "",
        descripcion: "üö® ALERTA R√ÅPIDA: Situaci√≥n de emergencia que requiere intervenci√≥n inmediata",
        timestamp: new Date().toISOString(),
        id: Date.now().toString(),
        fuente: "Alerta R√°pida"
      };

      this.reports.push(reporte);
      this.guardarReportes();
      this.actualizarEstadisticas();
      this.cargarReportesLista();
      
      this.mostrarNotificacion('üö® Alerta R√°pida', 'La denuncia de emergencia ha sido agregada a los reportes');
    }

    async enviarAFormspree(reporte) {
      try {
        const response = await fetch('https://formspree.io/f/xblzaejj', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(reporte)
        });
        
        if (!response.ok) throw new Error('Error en el env√≠o');
      } catch (error) {
        console.warn('Error enviando a Formspree:', error);
      }
    }

    cargarReportesLista() {
      const reportList = document.getElementById('report-list');
      let reportesFiltrados = this.reports;

      if (this.filters.type !== 'all') {
        reportesFiltrados = reportesFiltrados.filter(r => r.tipo === this.filters.type);
      }

      if (this.filters.urgency !== 'all') {
        reportesFiltrados = reportesFiltrados.filter(r => r.urgencia === this.filters.urgency);
      }

      reportesFiltrados = reportesFiltrados.slice(-10).reverse();

      if (reportesFiltrados.length === 0) {
        reportList.innerHTML = '<li class="empty-state">No hay reportes que coincidan con los filtros</li>';
        return;
      }

      reportList.innerHTML = reportesFiltrados.map(report => this.crearElementoReporte(report)).join('');
    }

    crearElementoReporte(report) {
      const typeLabels = {
        sismo: 'Sismo',
        inundacion: 'Inundaci√≥n',
        deslizamiento: 'Deslizamiento',
        incendio: 'Incendio',
        emergencia: 'Emergencia',
        otro: 'Otro'
      };

      const urgencyLabels = {
        alta: 'Alta',
        media: 'Media',
        baja: 'Baja'
      };

      const urgencyClasses = {
        alta: 'priority-high',
        media: 'priority-medium',
        baja: 'priority-low'
      };

      const isEmergency = report.urgencia === 'alta';
      const emergencyClass = isEmergency ? 'emergency' : '';
      const esAlertaRapida = report.fuente === 'Alerta R√°pida';
      const badge = esAlertaRapida ? ' <span style="color: var(--danger); font-size: 0.7em;">üö® R√ÅPIDA</span>' : '';

      return `
        <li class="report-item ${emergencyClass}">
          <div class="report-header">
            <span class="report-type ${isEmergency ? 'emergency' : ''}">${typeLabels[report.tipo] || report.tipo}${badge}</span>
            <span class="report-location">${report.lugar}</span>
          </div>
          <p class="report-description">${report.descripcion}</p>
          <div class="report-meta">
            <span>Por: ${report.nombre}</span>
            <div>
              <span class="report-priority ${urgencyClasses[report.urgencia]}">${urgencyLabels[report.urgencia]} prioridad</span>
              <span>${new Date(report.timestamp).toLocaleDateString()}</span>
            </div>
          </div>
        </li>
      `;
    }

    mostrarNotificacion(titulo, mensaje, duracion = 3000) {
      const toast = document.getElementById('notificationToast');
      const titleElem = document.getElementById('toastTitle');
      const messageElem = document.getElementById('toastMessage');
      
      titleElem.textContent = titulo;
      messageElem.textContent = mensaje;
      
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, duracion);
    }
  }
  async function mostrarAlertaRapida() {
    const modal = document.getElementById('emergencyModal');
    const status = document.getElementById('locationStatus');
    const sendBtn = document.getElementById('sendEmergencyBtn');
    
    modal.style.display = 'flex';
    sendBtn.disabled = true;
    status.innerHTML = '<p><i class="fas fa-map-marker-alt"></i> Obteniendo tu ubicaci√≥n...</p>';
    
    try {
      const position = await obtenerUbicacion();
      ubicacionUsuario = position;
      
      status.innerHTML = `
        <p style="color: var(--success);">
          <i class="fas fa-check-circle"></i> Ubicaci√≥n confirmada<br>
          <small>Lat: ${position.coords.latitude.toFixed(4)}, Lon: ${position.coords.longitude.toFixed(4)}</small>
        </p>
      `;
      
      document.getElementById('locationPreview').textContent = 
        `Lat: ${position.coords.latitude.toFixed(4)}, Lon: ${position.coords.longitude.toFixed(4)}`;
      
      sendBtn.disabled = false;
      
    } catch (error) {
      console.warn('Error obteniendo ubicaci√≥n:', error);
      
      status.innerHTML = `
        <p style="color: var(--warning);">
          <i class="fas fa-exclamation-triangle"></i> Ubicaci√≥n aproximada<br>
          <small>Se usar√° ubicaci√≥n por red. Activa GPS para mayor precisi√≥n.</small>
        </p>
      `;
      
      document.getElementById('locationPreview').textContent = 'Ubicaci√≥n aproximada por IP';
      
      ubicacionUsuario = {
        coords: {
          latitude: -16.5000,
          longitude: -68.1500,
          accuracy: 50000
        }
      };
      sendBtn.disabled = false;
    }
  }

  function obtenerUbicacion() {
    return new Promise((resolve, reject) => {
      if (!navigator.geolocation) {
        reject(new Error('Geolocalizaci√≥n no soportada'));
        return;
      }
      
      navigator.geolocation.getCurrentPosition(resolve, reject, {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      });
    });
  }

  async function enviarAlertaRapida() {
    const sendBtn = document.getElementById('sendEmergencyBtn');
    const originalText = sendBtn.innerHTML;
    
    sendBtn.disabled = true;
    sendBtn.innerHTML = '<span class="loading-spinner" style="width: 20px; height: 20px;"></span> ENVIANDO ALERTA...';

    try {
      const alertaData = {
        tipo: "EMERGENCIA_INMEDIATA",
        gravedad: "CRITICA",
        descripcion: "üö® EMERGENCIA - Se requiere auxilio inmediato",
        timestamp: new Date().toISOString(),
        ubicacion: ubicacionUsuario ? {
          lat: ubicacionUsuario.coords.latitude,
          lng: ubicacionUsuario.coords.longitude,
          precision: ubicacionUsuario.coords.accuracy
        } : "Ubicaci√≥n no disponible",
        usuario: "Usuario SAT Denuncias",
        fuente: "Alerta Bolivia - Sistema de Denuncias"
      };

      const resultadoFormspree = await enviarAFormspree(alertaData);
      const resultadoWhatsApp = await enviarWhatsApp(alertaData);

      if (window.sistemaDenuncias) {
        window.sistemaDenuncias.agregarDenunciaRapida(alertaData);
      }

      mostrarConfirmacionEnvio(resultadoFormspree, resultadoWhatsApp);
      
      setTimeout(() => {
        closeEmergencyModal();
        sendBtn.innerHTML = originalText;
        sendBtn.disabled = false;
      }, 3000);

    } catch (error) {
      console.error('Error enviando alerta:', error);
      if (window.sistemaDenuncias) {
        window.sistemaDenuncias.mostrarNotificacion(
          '‚ùå Error', 
          'No se pudo enviar la alerta completa. Por favor, llama al 911 directamente.',
          5000
        );
      }
      sendBtn.innerHTML = originalText;
      sendBtn.disabled = false;
    }
  }

  async function enviarAFormspree(alertaData) {
    return new Promise((resolve) => {
      try {
        document.getElementById('formspreeUbicacion').value = 
          alertaData.ubicacion.lat ? 
          `Lat: ${alertaData.ubicacion.lat}, Lon: ${alertaData.ubicacion.lng}` : 
          'Ubicaci√≥n no disponible';
        
        document.getElementById('formspreeTimestamp').value = alertaData.timestamp;

        const form = document.getElementById('emergencyFormspreeForm');
        const formData = new FormData(form);
        
        fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        })
        .then(response => {
          if (response.ok) {
            resolve({ exito: true, destino: 'Formspree' });
          } else {
            resolve({ exito: false, destino: 'Formspree', error: 'Error HTTP' });
          }
        })
        .catch(error => {
          resolve({ exito: false, destino: 'Formspree', error: error.message });
        });
        
      } catch (error) {
        resolve({ exito: false, destino: 'Formspree', error: error.message });
      }
    });
  }

  async function enviarWhatsApp(alertaData) {
    return new Promise((resolve) => {
      try {
        const numeroTelefono = "59162679441";

        let enlaceMaps = "Ubicaci√≥n no disponible";
        if (alertaData.ubicacion.lat) {
          enlaceMaps = `https://www.google.com/maps?q=${alertaData.ubicacion.lat},${alertaData.ubicacion.lng}`;
        }

        const mensaje = `üö® EMERGENCIA

üìç ${enlaceMaps}

‚åö ${new Date().toLocaleTimeString('es-BO')}

‚ö†Ô∏è Se requiere auxilio inmediato`;

        const whatsappLink = `https://wa.me/${numeroTelefono}?text=${encodeURIComponent(mensaje)}`;
        
        window.open(whatsappLink, '_blank');
        
        resolve({ 
          exito: true, 
          destino: 'WhatsApp', 
          metodo: 'Enlace directo',
          mensaje: 'WhatsApp abierto con ubicaci√≥n en Google Maps'
        });
        
      } catch (error) {
        resolve({ 
          exito: false, 
          destino: 'WhatsApp', 
          error: error.message 
        });
      }
    });
  }

  function mostrarConfirmacionEnvio(resultadoFormspree, resultadoWhatsApp) {
    let mensaje = '‚úÖ Alerta enviada correctamente a:\n';
    
    if (resultadoFormspree.exito) {
      mensaje += '‚Ä¢ üìß Formspree (correo)\n';
    } else {
      mensaje += '‚Ä¢ ‚ùå Formspree fall√≥\n';
    }
    
    if (resultadoWhatsApp.exito) {
      mensaje += `‚Ä¢ üì± WhatsApp (con enlace a Google Maps)\n`;
      setTimeout(() => {
        if (window.sistemaDenuncias) {
          window.sistemaDenuncias.mostrarNotificacion(
            'üì± WhatsApp Listo', 
            'Ubicaci√≥n en Google Maps - Solo presiona "Enviar"'
          );
        }
      }, 1000);
    } else {
      mensaje += '‚Ä¢ ‚ùå WhatsApp fall√≥\n';
    }
    
    if (window.sistemaDenuncias) {
      window.sistemaDenuncias.mostrarNotificacion('üö® Alerta Enviada', mensaje, 5000);
    }
  }

  function closeEmergencyModal() {
    document.getElementById('emergencyModal').style.display = 'none';
    ubicacionUsuario = null;
  }
  function abrirMapa() {
    document.getElementById('mapModal').style.display = 'block';
    setTimeout(() => {
      inicializarMapa();
    }, 100);
  }

  function cerrarMapa() {
    document.getElementById('mapModal').style.display = 'none';
    if (mapa) {
      mapa.remove();
      mapa = null;
    }
    coordenadasSeleccionadas = null;
  }

  function inicializarMapa() {
    const mapElement = document.getElementById('map');
    
    if (mapa) {
      mapa.remove();
    }

    mapa = L.map('map').setView([-16.5000, -68.1500], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(mapa);

    mapa.on('click', function(e) {
      agregarMarcador(e.latlng.lat, e.latlng.lng);
    });

    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        (position) => {
          const lat = position.coords.latitude;
          const lng = position.coords.longitude;
          mapa.setView([lat, lng], 16);
          agregarMarcador(lat, lng);
          obtenerDireccion(lat, lng);
        },
        (error) => {
          agregarMarcador(-16.5000, -68.1500);
        },
        {
          enableHighAccuracy: true,
          timeout: 10000,
          maximumAge: 0
        }
      );
    } else {
      agregarMarcador(-16.5000, -68.1500);
    }
  }

  function agregarMarcador(lat, lng) {
    if (marcador) {
      mapa.removeLayer(marcador);
    }

    coordenadasSeleccionadas = { lat: lat, lng: lng };
    
    marcador = L.marker([lat, lng]).addTo(mapa);
    
    mapa.setView([lat, lng], Math.max(mapa.getZoom(), 16));

    document.getElementById('selectedLocation').textContent = `${lat.toFixed(6)}, ${lng.toFixed(6)}`;
    
    const confirmBtn = document.getElementById('confirmBtn');
    confirmBtn.disabled = false;
    confirmBtn.style.background = 'linear-gradient(135deg, var(--primary), var(--secondary))';
    
    obtenerDireccion(lat, lng);
  }

  async function obtenerDireccion(lat, lng) {
    try {
      const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`);
      const data = await response.json();
      
      if (data.display_name) {
        direccionSeleccionada = data.display_name;
        document.getElementById('selectedLocation').textContent = direccionSeleccionada;
      }
    } catch (error) {
      document.getElementById('selectedLocation').textContent = `${lat.toFixed(6)}, ${lng.toFixed(6)}`;
    }
  }

  function confirmarUbicacion() {
    if (!coordenadasSeleccionadas) {
      if (window.sistemaDenuncias) {
        window.sistemaDenuncias.mostrarNotificacion('üìç Selecciona ubicaci√≥n', 'Por favor, selecciona una ubicaci√≥n en el mapa primero');
      }
      return;
    }

    const lat = coordenadasSeleccionadas.lat;
    const lng = coordenadasSeleccionadas.lng;
    
    document.getElementById('lat-input').value = lat.toFixed(6);
    document.getElementById('lon-input').value = lng.toFixed(6);
    
    const lugarInput = document.getElementById('lugar-input');
    if (lugarInput && direccionSeleccionada) {
      lugarInput.value = direccionSeleccionada;
    } else if (lugarInput) {
      lugarInput.value = `Ubicaci√≥n: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;
    }
    
    if (window.sistemaDenuncias) {
      window.sistemaDenuncias.mostrarNotificacion('üìç Ubicaci√≥n Confirmada', 'La ubicaci√≥n ha sido seleccionada correctamente');
    }
    
    cerrarMapa();
  }
  function obtenerUbicacionPrecisa() {
    return new Promise((resolve, reject) => {
      if (!navigator.geolocation) {
        reject(new Error('La geolocalizaci√≥n no es soportada por tu navegador'));
        return;
      }

      const options = {
        enableHighAccuracy: true,
        timeout: 15000,
        maximumAge: 0
      };

      navigator.geolocation.getCurrentPosition(resolve, reject, options);
    });
  }

  function obtenerUbicacionActual() {
    if (!navigator.geolocation) {
      if (window.sistemaDenuncias) {
        window.sistemaDenuncias.mostrarNotificacion('üìç Geolocalizaci√≥n', 'La geolocalizaci√≥n no es soportada por tu navegador');
      }
      return;
    }

    const loadingOverlay = document.getElementById('loadingOverlay');
    loadingOverlay.style.display = 'flex';

    obtenerUbicacionPrecisa()
      .then(position => {
        const lat = position.coords.latitude;
        const lng = position.coords.longitude;
        const accuracy = position.coords.accuracy;
        
        document.getElementById('lat-input').value = lat.toFixed(6);
        document.getElementById('lon-input').value = lng.toFixed(6);

        const accuracyElement = document.getElementById('locationAccuracy');
        const accuracyValue = document.getElementById('accuracyValue');
        accuracyElement.style.display = 'flex';
        accuracyValue.textContent = Math.round(accuracy);
      
        if (accuracy < 20) {
          accuracyElement.className = 'location-accuracy accuracy-high';
        } else if (accuracy < 100) {
          accuracyElement.className = 'location-accuracy accuracy-medium';
        } else {
          accuracyElement.className = 'location-accuracy accuracy-low';
        }

        obtenerDireccionParaFormulario(lat, lng);
        
        if (window.sistemaDenuncias) {
          window.sistemaDenuncias.mostrarNotificacion('üìç Ubicaci√≥n Obtenida', 
            `Coordenadas actualizadas (precisi√≥n: ${Math.round(accuracy)}m)`);
        }
      })
      .catch(error => {
        console.error('Error obteniendo ubicaci√≥n:', error);
        let mensajeError = 'Error obteniendo la ubicaci√≥n';
        
        switch(error.code) {
          case error.PERMISSION_DENIED:
            mensajeError = 'Permiso de ubicaci√≥n denegado. Por favor, habilita la ubicaci√≥n en tu navegador.';
            break;
          case error.POSITION_UNAVAILABLE:
            mensajeError = 'Informaci√≥n de ubicaci√≥n no disponible.';
            break;
          case error.TIMEOUT:
            mensajeError = 'Tiempo de espera agotado al obtener la ubicaci√≥n.';
            break;
        }
        
        if (window.sistemaDenuncias) {
          window.sistemaDenuncias.mostrarNotificacion('‚ùå Error de Ubicaci√≥n', mensajeError, 5000);
        }
      })
      .finally(() => {
        loadingOverlay.style.display = 'none';
      });
  }

  async function obtenerDireccionParaFormulario(lat, lng) {
    try {
      const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`);
      const data = await response.json();
      if (data.display_name) {
        const lugarInput = document.getElementById('lugar-input');
        if (lugarInput) {
          const partesDireccion = data.display_name.split(',');
          const direccionCorta = partesDireccion.slice(0, 3).join(', ');
          lugarInput.value = direccionCorta;
        }
      }
    } catch (error) {
      console.log('No se pudo obtener la direcci√≥n:', error);
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    window.sistemaDenuncias = new SistemaDenuncias();
    
    const titleSection = document.querySelector('.animated-title-section');
    if (titleSection) {
      titleSection.style.opacity = '0';
      titleSection.style.transform = 'translateY(30px)';
      titleSection.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
      
      setTimeout(() => {
        titleSection.style.opacity = '1';
        titleSection.style.transform = 'translateY(0)';
      }, 300);
    }
    
    setTimeout(() => {
      const alertBanner = document.getElementById('alertBanner');
      if (alertBanner) {
        alertBanner.classList.remove('hidden');
      }
    }, 2000);

    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, observerOptions);

    const statCards = document.querySelectorAll('.stat-card');
    statCards.forEach((card, index) => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(20px)';
      card.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
      observer.observe(card);
    });

    const formContainer = document.querySelector('.form-container');
    if (formContainer) {
      formContainer.style.opacity = '0';
      formContainer.style.transform = 'translateY(30px)';
      formContainer.style.transition = 'opacity 0.6s ease 0.3s, transform 0.6s ease 0.3s';
      observer.observe(formContainer);
    }

    const reportsSection = document.querySelector('.reports-section');
    if (reportsSection) {
      reportsSection.style.opacity = '0';
      reportsSection.style.transform = 'translateY(30px)';
      reportsSection.style.transition = 'opacity 0.6s ease 0.4s, transform 0.6s ease 0.4s';
      observer.observe(reportsSection);
    }

    console.log('%cüö® Sistema de Denuncias Alerta Bolivia', 'font-size: 24px; font-weight: bold; color: #00B4D4;');
    console.log('%cSistema de reportes de incidentes y emergencias', 'color: #80D0FF;');
  });

  window.addEventListener('error', (event) => {
    console.error('Error en sistema de denuncias:', event.error);
    if (window.sistemaDenuncias) {
      window.sistemaDenuncias.mostrarNotificacion(
        '‚ö†Ô∏è Error del Sistema', 
        'Se ha producido un error. Por favor, recarga la p√°gina.',
        5000
      );
    }
  });

  window.addEventListener('online', () => {
    if (window.sistemaDenuncias) {
      window.sistemaDenuncias.mostrarNotificacion(
        '‚úÖ Conexi√≥n Restablecida', 
        'El sistema se ha reconectado correctamente.',
        3000
      );
    }
  });

  window.addEventListener('offline', () => {
    if (window.sistemaDenuncias) {
      window.sistemaDenuncias.mostrarNotificacion(
        '‚ö†Ô∏è Sin Conexi√≥n', 
        'Est√°s trabajando en modo offline. Tus reportes se guardar√°n localmente.',
        5000
      );
    }
  });
</script>
</body>
</html>
